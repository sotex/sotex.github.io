---
layout: post
title:  "使用 ArcGIS Desktop 切瓦片"
date:   2019-05-28
categories: 地理信息
tags: ArcGIS GIS TileCache 瓦片 TMS
comments: 1
---

# 使用 ArcGIS Desktop 切瓦片

[TOC]

[博客园文章地址 https://www.cnblogs.com/oloroso/p/10936522.html](https://www.cnblogs.com/oloroso/p/10936522.html)

## 1、生成切片缓存切片方案

ArcGIS有默认的切片方案，如果需要自定义切片规则，需要先生成一个切片方案。

打开ArcMap，打开 **工具箱(Tools Box) --> 系统工具箱(System Tools Box) --> 数据管理工具(Data Managment Tools) --> 切片缓存(Tile Cache)-->生成切片缓存切片方案(Generate Tile Cache Tiling Scheme)**

![1559011643445](Image/使用ArcGISDesktop切瓦片/1559011643445.png)

**各个选项简要说明：**

-   1、输入数据源：这个是用来确定这个切片方案能够切多少级的，切片的最大级别的分辨率**最多能够是**小于等于输入的数据源的分辨率，也就是说最多能切到刚好等于或者小于数据源的分辨率，就不能再继续往下切了。
-   2、输出切片方案：也就是这个切片方案的保存位置，不能是一个已经存在的文件。
-   3、生成方案：二选一，**NEW** 表示创建一个新的，**PREDEFINED** 表示基于一个已有的切片方案来创建。
-   4、比例级数：指定要切多少级，这个数据会自动根据输入数据源的分辨率进行调整。
-   5、比例：指定比例级数后，会自动计算出相应的比例系数列表，如果需要添加，则可以在这里输入后，点击右侧的`+`按钮进行添加。移除则是在表格中选择后，点击右侧的`X`按钮进行移除。
-   6、切片原点：就是切片的第一个瓦片(0,0)的左上角点坐标。
-   7、每英寸的点数(像素)：就是DPI的设置，一般国内的切片96（天地图），但是WMTS服务通常是90.714（WMTS标准里面就是，但是ArcGIS Desktop10.2/3版本，由于计算使用的经纬度与米的换算系数偏小的原因，导致其计算比例尺与分辨率的结果有问题，其加载WMTS图层时可见）
-   8、切片大小（以像素为单位）：瓦片的大小，通常是`256 x 256`。经过我的测试，大部分情况下`512 x 512`的瓦片大小，在切瓦片的速度和发布成服务后的浏览速度上，都是优于256大小的，1024大小的瓦片在大多数时候也是优于256的，但与512差异不大。
-   9、切片格式：主要是**PNGx、JPEG、MIXED**。MIXED混合格式，指的是在切片的时候，如果检测到瓦片内有透明区域，则这个瓦片使用PNG32格式，如果没有，则使用JPEG格式。这样做可以在不失去透明通道的前提下，有效降低瓦片数据文件的大小。
-   10、切片压缩质量：仅对JPEG（包括MIXED中使用JPEG的瓦片）有效，参数值需要介于1-100之间，默认是75。
-   11、存储格式：**COMPACT** 紧凑格式，也就是把多个瓦片（最多128x128个）存储到一个`bundle/bundlx`文件的形式，避免出现大量碎文件。**EXPLODED** 分散格式，就是把每一个瓦片存储成一个图片文件，这个形式的瓦片不能和tpk包一起使用。

参考：[Generate Tile Cache Tiling Scheme](http://desktop.arcgis.com/en/arcmap/10.5/tools/data-management-toolbox/generate-tile-cache-tiling-scheme.htm)



## 2、切瓦片

切瓦片在ArcGIS里面没有直接使用这个名称，在“管理切片缓存”里面。

打开ArcMap，打开 **工具箱(Tools Box) --> 系统工具箱(System Tools Box) --> 数据管理工具(Data Managment Tools) --> 切片缓存(Tile Cache)-->管理切片缓存(Manage Tile Cache)**

![1559017058566](Image/使用ArcGISDesktop切瓦片/1559017058566.png)

**各个选项简要说明：**

-   1、缓存位置：切出来的瓦片保存的文件夹，也可以是已经存在的瓦片目录，因为这里不仅仅是可以切瓦片。
-   2、缓存名称：切出来的瓦片保存的子一级文件夹名称，可以为空。
-   3、管理模式：**RECREATE_ALL_TILES** 替换所有瓦片，不管存不存在。**RECREATE_EMPTY_TILES** 替换空瓦片，也就是如果存在则不替换。**DELETE_TILES** 删除瓦片，这个选项用来删除所有的瓦片数据文件，但是不删除目录结构。（注意：如果输出是已经存在的瓦片目录，则该目录下的**conf.cdi**并不会更新，这在替换了数据源等情况下可能导致输出瓦片与描述信息不对应）
-   4、输入数据源：选择要切片的数据文件，虽然这里写着可选，但是如果没有指定就会报错。数据文件必须指定了坐标系，且能够转换到WGS84椭球下。
-   5、输入切片方案：切片的规则。**ARCGISONLINE_SCHEME** 使用ArcGIS在线地图的默认切片规则（3857）。**IMPORT_SCHEME** 导入方案，可以导入自己创建的切片方案。（ArcGIS10.5版本有更多模式）
-   6、最小/最大 缓存比例：计算切片的比例系数的上下限，在这个区间之外的将被忽略。
-   7、感兴趣区：定义要切片的区域。这里可以设置一个矢量文件或者绘制的矢量对象。
-   8、最大源像元大小：这个是对有金字塔文件的数据使用的。如果为空，则使用全部金字塔。如果不为空，则仅使用像元大小在指定值以内的金字塔层。

参考：[Manage Tile Cache](http://desktop.arcgis.com/en/arcmap/10.5/tools/data-management-toolbox/manage-tile-cache.htm)