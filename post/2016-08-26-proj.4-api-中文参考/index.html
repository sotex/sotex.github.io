  <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> Proj.4 API 中文参考 &middot; 风吹过 </title>
    
    <link rel="stylesheet" type="text/css" href="http://sotex.github.io/css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://sotex.github.io/css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="风吹过" />
    
    <script src="http://sotex.github.io/js/jquery.min.js"></script>
    <script src="http://sotex.github.io/js/main.min.js">
    </script>
</head>

  <body>
    <div id="scriptHeader">
    <span class="mobile btn-mobile-menu">
            <i class="fa fa-bars btn-mobile-menu__icon"></i>
            <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>
    <header class="
        
            panel-cover panel-cover--collapsed
        " >
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <a href="http://sotex.github.io//" title="link to homepage for 风吹过"> <img src="/images/user.png" width="80" alt="风吹过 logo" class="panel-cover__logo logo" /> </a> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://sotex.github.io//"  title="link to homepage for 风吹过">风吹过</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  以前，晚餐后在学校田径场的大榕树下，散散步吹吹风，累了就去图书馆看看书，感觉真好。  </p>
                <hr class="panel-cover__divider panel-cover__divider--secondary" />
                <div class="navigation-wrapper">
                    <nav class="cover-navigation cover-navigation--primary">
                        <ul class="navigation">
                            <li class="navigation__item"><a href="http://sotex.github.io/#blog" title="查看 风吹过 博客" class="blog-button">博客</a> </li></br>
                            <li class="navigation__item"><a href="/pages/about.html" title="查看简介 " class="blog-button">简介</a> </li></br> 
                            
                       </ul>
                    </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
	
        
        <li class="navigation__item">
            <a href="http://cnblogs.com/oloroso" title="@oloroso 博客园"> <i class='fa fa-twitter'></i> <span class="label">cnblogs</span> </a>
        </li> 
	
	
        
        <li class="navigation__item">
            <a href="https://github.com/sotex" title="sotex on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>
	
	
	
        
        <li class="navigation__item">
            <a href="mailto:ymwh@foxmail.com" title="Email ymwh@foxmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
</div>
<noscript>
    <style>
        #scriptHeader {display:none;}
        .navigation-wrapper{
            display: block;
            top: 0;
        }
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url()">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <a href="http://sotex.github.io//" title="link to homepage for 风吹过"> <img src="/images/user.png" width="80" alt="风吹过 logo" class="panel-cover__logo logo" /> </a> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://sotex.github.io//"  title="link to homepage for 风吹过">风吹过</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  以前，晚餐后在学校田径场的大榕树下，散散步吹吹风，累了就去图书馆看看书，感觉真好。  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                                <li class="navigation__item"><a href="http://sotex.github.io//#blog" title="查看 风吹过 博客" class="blog-button">博客</a> </li></br>
                                <li class="navigation__item"><a href="/pages/about.html" title="查看简介" class="blog-button">简介</a> </li></br> 
                                
                           </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation"> 
	
        
        <li class="navigation__item">
            <a href="http://cnblogs.com/oloroso" title="@oloroso 博客园"> <i class='fa fa-twitter'></i> <span class="label">cnblogs</span> </a>
        </li> 
	
	
        
        <li class="navigation__item">
            <a href="https://github.com/sotex" title="sotex on github"> <i class='fa fa-github'></i> <span class="label">Github</span> </a>
        </li>  </br>
	
	
	
        
        <li class="navigation__item">
            <a href="mailto:ymwh@foxmail.com" title="Email ymwh@foxmail.com"> <i class='fa fa-envelope-o'></i> <span class="label">Email</span> </a>
        </li>  </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <div class="post">
          <h1>Proj.4 API 中文参考</h1>
          <span class="post-date">2016年08月26日</span>
          <p>[TOC]
<a href="http://www.cnblogs.com/oloroso/archive/2016/08/26/5809884.html">博客园文章地址 http://www.cnblogs.com/oloroso/archive/2016/08/26/5809884.html</a>
#ProjAPI
<a href="https://github.com/OSGeo/proj.4/wiki/ProjAPI">https://github.com/OSGeo/proj.4/wiki/ProjAPI</a></p>

<p>Tom Kralidis在2015年5月27日编辑此页·修订4</p>

<p>##简介</p>

<p>执行<code>pj_init()</code>选择并初始化一个由它的参数决定参数的制图投影坐标系。<code>argc</code>是<code>argv</code>数组中的元素个数，<code>argv</code>数组每个元素是单个投影的关键字参数(+proj arguments)。该列表中必须包含<code>proj=投影</code>、<code>地球半径</code>或<code>椭圆参数</code>。如果初始化的投影是有效的，返回一个<code>projPJ</code>结构体的地址，失败返回NULL。</p>

<p><code>pj_init_plus()</code>函数的工作方式与<code>pj_init()</code>类似，但将投影参数定义在单个字符串内，且每个参数带有一个<code>+</code>前缀。例如:<code>+proj=utm +zone=11 +ellps=WGS84</code>。</p>

<p><code>pj_init()</code>的返回值用作投影正算(forward)或者投影逆算(inverse)中的<code>proj</code>参数。投影计算中的参数结构体<code>projUV</code>中的<code>U</code>代表<code>经度</code>或者<code>x</code>，<code>V</code>代表<code>维度</code>或者<code>y</code>，经度和维度都是以弧度单位的。如果操作失败，<code>projUV</code>中的两个值都设置为<code>HUGE_VAL</code>(在math.h中定义<a href="http://blog.csdn.net/poechant/article/details/7235594)。">http://blog.csdn.net/poechant/article/details/7235594)。</a></p>

<p>注意：所有投影都有正算(forward)模式，但却不是都有逆算(inverse)模式。如果投影没有逆算模式，那么<code>projPJ</code>中成员<code>inv</code>将设置为<code>NULL</code>。</p>

<p><code>pj_transform</code>函数用于转换两个坐标系统之间的点。除了投影坐标与地理坐标之间的转换，也可以进行基准面(datum)之间的转换。不同于<code>pj_fwd()</code>和<code>pj_inv()</code>，这里也允许坐标系定义参数<code>projPJ*</code>是地理坐标(使用<code>+proj=latlong</code>定义)。<code>x</code>、<code>y</code>、<code>z</code>数组用于传入计算值，传出计算结果。该函数成功返回<code>0</code>，失败返回错误号(查看<code>inpj_errno</code>)。</p>

<p>由<code>projection(projPJ)</code>关联的内存，可能需要使用<code>pj_free()</code>释放。</p>

<p>##示例</p>

<p>The following program reads latitude and longitude values in decimal degress, performs Mercator projection with a Clarke 1866 ellipsoid and a 33° latitude of true scale and prints the projected cartesian values in meters:</p>

<p>下面程序读取十进制的经度和维度值，进行克拉克1866椭球正确范围33°维度的墨卡托投影计算，并打印米单位的笛卡尔坐标值。
<a href="https://en.wikipedia.org/wiki/North_American_Datum">北美大地基准维基百科</a></p>

<p>##示例</p>

<p>The following program reads latitude and longitude values in decimal degress, performs Mercator projection with a Clarke 1866 ellipsoid and a 33° latitude of true scale and prints the projected cartesian values in meters:</p>

<p>下面程序读取十进制的经度和维度值，进行克拉克1866椭球正确范围33°维度的墨卡托投影计算，并打印米单位的笛卡尔坐标值。</p>

<pre><code class="language-c">#include &lt;proj_api.h&gt;

main(int argc, char **argv) {
     projPJ pj_merc, pj_latlong;
     double x, y;

     if (!(pj_merc = pj_init_plus(&quot;+proj=merc +ellps=clrk66 +lat_ts=33&quot;)) )
        exit(1);
     if (!(pj_latlong = pj_init_plus(&quot;+proj=latlong +ellps=clrk66&quot;)) )
        exit(1);
     while (scanf(&quot;%lf %lf&quot;, &amp;x, &amp;y) == 2) {
        x *= DEG_TO_RAD;
        y *= DEG_TO_RAD;
        p = pj_transform(pj_latlong, pj_merc, 1, 1, &amp;x, &amp;y, NULL );
        printf(&quot;%.2f\t%.2f\n&quot;, x, y);
     }
     exit(0);
}
</code></pre>

<p>在此程序中,输入-16 20.25将得到结果-1495284.21 1920596.79.</p>

<p>##API函数
###基本API</p>

<pre><code class="language-c">int pj_transform( projPJ srcdefn, projPJ dstdefn, long point_count, int point_offset, double *x, double *y, double *z );
</code></pre>

<p>转换点<code>x/y/z</code>，从源坐标系统到目标坐标系统(<a href="https://github.com/OSGeo/proj.4/wiki/pj_transform">更多信息</a>).</p>

<pre><code class="language-c">projPJ pj_init_plus(const char *definition);
</code></pre>

<p>从字符串definition创建一个projPJ坐标系统对象(<a href="https://github.com/OSGeo/proj.4/wiki/pj_init_plus">更多信息</a>).</p>

<pre><code class="language-c">void pj_free( projPJ pj );
</code></pre>

<p>释放与<code>pj</code>关联的所有资源.</p>

<p>###高级函数</p>

<pre><code class="language-c">int pj_is_latlong( projPJ pj );
</code></pre>

<p>返回TRUE表示是地理坐标系统(proj=latlong).</p>

<pre><code class="language-c">int pj_is_geocent( projPJ pj );
</code></pre>

<p>返回TRUE表示是地心坐标系统(proj=geocent).</p>

<pre><code class="language-c">char *pj_get_def( projPJ pj, int options);
</code></pre>

<p>返回PROJ.4初始化字符串，用于<code>pj_init_plus()</code>可产生此坐标系统。但会尽可能多的扩大定义(例如添加:+init= 和 +datum= definitions).</p>

<pre><code class="language-c">projPJ pj_latlong_from_proj( projPJ pj_in );
</code></pre>

<p>返回一个新的坐标系定义。就是<code>pj_in</code>内部的地理坐标(lat/long)系统.</p>

<p>###环境函数</p>

<pre><code class="language-c">void pj_set_finder( const char *(*new_finder)(const char *) );
</code></pre>

<p>Install a custom function for finding init and grid shift files.
安装用于查找<code>init</code>和<code>grid shift</code>(网格转换)文件的自定义函数。</p>

<pre><code class="language-c">void pj_set_searchpath ( int count, const char **path );
</code></pre>

<p>Set a list of directories to search for init and grid shift files.
设置一个目录列表去搜索<code>init</code>和<code>grid shift</code>文件。</p>

<pre><code class="language-c">void pj_deallocate_grids( void );
</code></pre>

<p>Frees all resources associated with loaded and cached datum shift grids.
释放加载和缓存的<code>基准转换网格</code>关联的所有资源。</p>

<pre><code class="language-c">char *pj_strerrno( int );
</code></pre>

<p>Returns the error text associated with the passed in error code.
返回错误代码关联的错误文本。</p>

<pre><code class="language-c">int *pj_get_errno_ref( void );
</code></pre>

<p>Returns a pointer to the global pj_errno error variable.
返回全局的<code>pj_errno</code>错误变量地址。</p>

<pre><code class="language-c">const char *pj_get_release( void );
</code></pre>

<p>Returns an internal string describing the release version.
返回描述发行版本的内部字符串。</p>

<p>###废弃(过时)函数</p>

<pre><code class="language-c">XY pj_fwd( LP lp, PJ *P );
</code></pre>

<pre><code class="language-c">LP pj_inv( XY xy, PJ *P );
</code></pre>

<pre><code class="language-c">projPJ pj_init(int argc, char **argv);
</code></pre>

        </div>
        <div class="sharing">







</div>
        



      </div>
    </div>

  </body>
  
</html>
